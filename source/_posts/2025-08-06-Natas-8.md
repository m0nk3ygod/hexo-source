---
title: "Natas 8"
date: 2025-08-06 00:00:00 +0900
categories: [Overthewire, Natas]
tags: [overthewire, natas, web basic, study, basic php, encoding, decoding]
---

# Natas 8 / write-up

<br>

접속 정보 
- URL : http://natas8.natas.labs.overthewire.org
- 사용자 이름 : natas8
- 비밀번호 : ~~xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q~~

<br>

접속하면,

![Natas8 figure1](/assets/img/natas/2025-08-04-16-05-30.png)

사용자의 입력을 받을 수 있는 입력 폼과, 제출 버튼, `View sourcecode` 링크도 볼 수 있다.

<br>

우선 아무거나 입력해서 제출해보고 어떤 일이 일어나는지 확인해보자.  
(1234 입력해봤다)

![Natas8 figure2](/assets/img/natas/2025-08-04-16-07-15.png)

"Wrong secret" 이라는 문구가 출력된 것을 보면, 알맞은 입력 값을 입력해줘야하나 보다.

<br>

`View sourececode` 를 클릭해 소스코드가 어떻게 되어있는지 확인해보자.

![Natas8 figure3](/assets/img/natas/2025-08-04-16-10-02.png)

소스 코드를 확인해보았을 때, 해당 페이지는 다음과 같은 php 코드로 동작하고 있었다.

```php
<?

$encodedSecret = "3d3d516343746d4d6d6c315669563362";

function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}

if(array_key_exists("submit", $_POST)) {
    if(encodeSecret($_POST['secret']) == $encodedSecret) {
    print "Access granted. The password for natas9 is <censored>";
    } else {
    print "Wrong secret";
    }
}
?>
```

한 줄씩 분석해보자면...

```php
$encodedSecret = "3d3d516343746d4d6d6c315669563362";
```
- `$encodedSecret` 이라는 변수에 `3d3d516343746d4d6d6c3156695633623` 를 담는다. 


```php
function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}
```
- `encodeSecret()` 함수를 정의한다. 동작은 다음과 같다.
    - 함수의 인자($secret)을 `base64`로 **인코딩** 한 뒤,  
    `strrev()`(stringReverse) 함수로 **문자열을 역순**으로 만든다.  
    이후 `bin2hex` 함수를 통해 **2진수를 16진수** 로 변환하고,  
    해당 결과를 반환(return)한다.


```php
if(array_key_exists("submit", $_POST))
```
- `array_key_exists()` 함수를 통해 POST 배열 안에 `submit` 키가 있는지 확인한다.  
(폼을 제출했는지 확인하는 조건임)


```php
if(encodeSecret($_POST['secret']) == $encodedSecret) {
    print "Access granted. The password for natas9 is <censored>";
    } else {
    print "Wrong secret";
    }
```

- 아까 정의한 `encodeSecret()` 함수를 이용해 사용자 입력을 변환한 값과  
$ecnodedSecret(=3d3d516343746d4d6d6c315669563362)이 일치하는지 확인한다.
    - 일치하면 "Access granted..."
    - 불일치하면 "Wrong secret" 를 출력한다.

이제 어떻게 풀어야할까?

<br>

위 코드를 이해하고 조건에 부합하는 동작을 그려보자면...

```
(사용자 입력) -> base64 인코딩 -> 문자열 역순으로 재배치 -> 2진수를 16진수로 = 3d3d516343746d4d6d6c315669563362 
```

이렇게 되어야 할 것이다.

<br>

그렇다면 `사용자 입력` 값은 어떻게 되어야할까?

그냥 역순으로 변환을 진행해주면 될 것이다.

<br>

해당 풀이를 쉽게 진행할 수 있는 툴이 하나 있는데,  
바로 `Cyberchef` 라는 툴이다.

[Cyberchef 툴 사용하러 가기](https://gchq.github.io/CyberChef/)

![Natas8 figure 4](/assets/img/natas/2025-08-04-16-36-52.png)

접속하면 사진과 같은 화면이 보일 것이다.

<br>

간단하게 사용법을 알아보자면,

좌측 `Opertions` 탭에서는 여러 **인코딩/디코딩** 기법들이 모여있고,  
원하는 기법을 드래그해서 바로 옆 `Recipe` 탭에 두면 사용할 수 있다.  
그리고 우측에 보이는 탭의 상단은 `Input` 탭이고,  
해당 탭에 값을 집어 넣으면 `Recipe`의 기법에 맞게 변환되어 바로 아래 `Output`에 출력된다.

<br>

이제 알맞은 사용자 값을 알아내보자.

<br>

우선 최종 결과값인 `3d3d516343746d4d6d6c315669563362`을 input 탭에 넣어주고 시작해보자.

<br>

##### 1. From Hex

가장 첫번째로 해야할 디코딩은 `16진수에서 2진수로 바꿔주는 것`이다.

좌측 `Operations` 탭에서 "From Hex"라고 입력한 뒤 `Recipe`에 넣어주자.  
(From Hex는 16진수 디코딩을 진행하는 operation이다.)

![Natas8 figure5](/assets/img/natas/2025-08-04-16-46-06.png)

<br>

##### 2. Reverse

이후 문자열을 다시 `역순으로 재배열`해주자.

좌측 `Operations` 탭에서 "Reverse"라고 입력한 뒤 `Recipe`에 넣어주자.  
(Reverse는 문자열을 뒤집어주는 operation이다.)

![Natas8 figure6](/assets/img/natas/2025-08-04-16-50-54.png)

<br>

##### 3. From Base64

마지막으로 인코딩 되어있는 문자열을 `base64로 디코딩` 해주자.

좌측 `Operations` 탭에서 "From Base64"라고 입력한 뒤 `Recipe`에 넣어주자.  
(From Base64는 Base64로 디코딩을 진행하는 operation이다.)

![Natas8 figure7](/assets/img/natas/2025-08-04-16-53-23.png)

<br>

최종적으로 다음과 같은 결과값을 얻을 수 있다.

> oubWYf2kBq

<br>

이제 이 값을 입력값으로 넣고 제출해보면?

![Natas8 figure8](/assets/img/natas/2025-08-04-16-54-22.png)

찾았다 플래그.

<br>

- flag : ~~ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t~~